<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{metadata.title}}</title>
    <style>
        /* Professional Business Report Styling */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
            font-size: 11pt;
            line-height: 1.5;
            color: #1f2937;
            background: white;
        }
        
        .page {
            width: 8.5in;
            min-height: 11in;
            margin: 0 auto;
            padding: 1in 0.75in 1in 0.75in;
            background: white;
            page-break-after: always;
            position: relative;
        }
        
        .page:last-child {
            page-break-after: auto;
        }
        
        /* Headers and Footers */
        .page-header {
            position: fixed;
            top: 0.5in;
            left: 0.75in;
            right: 0.75in;
            height: 0.4in;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #2563eb;
            padding-bottom: 8px;
            font-size: 9pt;
            color: #6b7280;
        }
        
        .page-footer {
            position: fixed;
            bottom: 0.5in;
            left: 0.75in;
            right: 0.75in;
            height: 0.3in;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #e5e7eb;
            padding-top: 8px;
            font-size: 9pt;
            color: #6b7280;
        }
        
        /* Cover Page */
        .cover-page {
            text-align: center;
            padding-top: 1.5in;
        }
        
        .report-title {
            font-size: 28pt;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5in;
            line-height: 1.2;
        }
        
        .process-name {
            font-size: 20pt;
            font-weight: 600;
            color: #2563eb;
            margin-bottom: 1in;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 16px;
            display: inline-block;
        }
        
        .executive-summary-box {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px solid #cbd5e1;
            border-radius: 16px;
            padding: 32px;
            margin: 1in 0;
            text-align: left;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 24px;
        }
        
        .summary-metric {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }
        
        .metric-value {
            font-size: 24pt;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 8px;
        }
        
        .metric-label {
            font-size: 10pt;
            color: #6b7280;
            font-weight: 500;
        }
        
        /* Section Headers */
        .section {
            margin-bottom: 40px;
        }
        
        .section-title {
            font-size: 18pt;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid #2563eb;
        }
        
        .subsection-title {
            font-size: 14pt;
            font-weight: 600;
            color: #374151;
            margin: 24px 0 16px 0;
        }
        
        .content {
            font-size: 11pt;
            line-height: 1.6;
            color: #374151;
            margin-bottom: 20px;
            text-align: justify;
        }
        
        /* Opportunity Cards */
        .opportunity {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            background: #fefefe;
            page-break-inside: avoid;
        }
        
        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .opportunity-title {
            font-size: 13pt;
            font-weight: 600;
            color: #1f2937;
            flex: 1;
        }
        
        .priority-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 9pt;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .priority-high {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        
        .priority-medium {
            background: #fffbeb;
            color: #d97706;
            border: 1px solid #fed7aa;
        }
        
        .priority-low {
            background: #f0fdf4;
            color: #16a34a;
            border: 1px solid #bbf7d0;
        }
        
        .opportunity-description {
            font-size: 10.5pt;
            color: #374151;
            margin-bottom: 16px;
            line-height: 1.5;
        }
        
        .opportunity-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }
        
        .detail-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
        }
        
        .detail-title {
            font-size: 9pt;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
        
        .detail-content {
            font-size: 10pt;
            color: #374151;
            font-weight: 500;
        }
        
        /* Implementation Steps */
        .implementation-steps {
            margin-top: 16px;
        }
        
        .steps-list {
            padding-left: 0;
            list-style: none;
            counter-reset: step-counter;
        }
        
        .steps-list li {
            counter-increment: step-counter;
            margin-bottom: 12px;
            padding-left: 40px;
            position: relative;
            font-size: 10.5pt;
            line-height: 1.4;
        }
        
        .steps-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #2563eb;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9pt;
            font-weight: 600;
        }
        
        /* Roadmap Timeline */
        .roadmap-phase {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        
        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .phase-title {
            font-size: 14pt;
            font-weight: 600;
            color: #2563eb;
        }
        
        .phase-duration {
            background: #e0f2fe;
            color: #0369a1;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 9pt;
            font-weight: 600;
        }
        
        .phase-description {
            font-size: 10.5pt;
            color: #374151;
            margin-bottom: 16px;
            line-height: 1.5;
        }
        
        .phase-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        
        /* Charts and Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin: 24px 0;
        }
        
        .metric-box {
            text-align: center;
            padding: 24px;
            border-radius: 12px;
            border: 2px solid;
        }
        
        .metric-primary {
            background: #dbeafe;
            border-color: #2563eb;
        }
        
        .metric-success {
            background: #dcfce7;
            border-color: #16a34a;
        }
        
        .metric-warning {
            background: #fef3c7;
            border-color: #d97706;
        }
        
        .metric-purple {
            background: #f3e8ff;
            border-color: #7c3aed;
        }
        
        .big-number {
            font-size: 36pt;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .metric-primary .big-number { color: #2563eb; }
        .metric-success .big-number { color: #16a34a; }
        .metric-warning .big-number { color: #d97706; }
        .metric-purple .big-number { color: #7c3aed; }
        
        /* Page Breaks and Layout */
        .page-break {
            page-break-before: always;
        }
        
        .no-break {
            page-break-inside: avoid;
        }
        
        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        
        /* Print Optimization */
        @media print {
            body { -webkit-print-color-adjust: exact; }
            .page { margin: 0; }
        }
    </style>
</head>
<body>
    <!-- Page Header -->
    <div class="page-header">
        <div>
            {{#if branding.logo}}
            <img src="{{branding.logo}}" alt="{{branding.companyName}}" style="max-height: 40px;">
            {{else}}
            <span style="font-weight: 600; color: #2563eb;">{{branding.companyName}}</span>
            {{/if}}
        </div>
        <div>
            <strong>Business Process Audit Report</strong><br>
            {{reportDate}}
        </div>
    </div>
    
    <!-- Page Footer -->
    <div class="page-footer">
        <div>Generated by {{branding.companyName}} • ProcessAudit AI</div>
        <div>Page <span class="page-number"></span></div>
    </div>

    <!-- Cover Page -->
    <div class="page cover-page">
        <div class="report-title">Business Process<br>Audit Report</div>
        
        <div class="process-name">{{processData.processName}}</div>
        
        <div class="executive-summary-box">
            <h2 style="font-size: 16pt; font-weight: 600; color: #1f2937; margin-bottom: 16px; text-center;">
                Executive Summary Overview
            </h2>
            
            <div class="content" style="text-align: center; margin-bottom: 20px;">
                {{reportData.executiveSummary.overview}}
            </div>
            
            <div class="summary-grid">
                <div class="summary-metric metric-primary">
                    <div class="metric-value">{{reportData.executiveSummary.automationScore}}%</div>
                    <div class="metric-label">Automation Potential</div>
                </div>
                <div class="summary-metric metric-success">
                    <div class="metric-value">{{reportData.executiveSummary.estimatedROI}}</div>
                    <div class="metric-label">Projected Annual ROI</div>
                </div>
                <div class="summary-metric metric-warning">
                    <div class="metric-value">{{reportData.executiveSummary.timeSavings}}</div>
                    <div class="metric-label">Time Savings Potential</div>
                </div>
                <div class="summary-metric metric-purple">
                    <div class="metric-value">{{reportData.automationOpportunities.length}}</div>
                    <div class="metric-label">Opportunities Identified</div>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 1in;">
            <table class="table" style="max-width: 500px; margin: 0 auto;">
                <tr>
                    <td><strong>Industry:</strong></td>
                    <td>{{processData.industry}}</td>
                </tr>
                <tr>
                    <td><strong>Department:</strong></td>
                    <td>{{processData.department}}</td>
                </tr>
                <tr>
                    <td><strong>Process Owner:</strong></td>
                    <td>{{processData.processOwner}}</td>
                </tr>
                <tr>
                    <td><strong>Analysis Date:</strong></td>
                    <td>{{reportDate}}</td>
                </tr>
            </table>
        </div>
    </div>

    <!-- Executive Summary Page -->
    <div class="page page-break">
        <div class="section">
            <h1 class="section-title">Executive Summary</h1>
            
            <div class="content">
                {{reportData.executiveSummary.overview}}
            </div>
            
            <div class="subsection-title">Key Performance Metrics</div>
            
            <div class="metrics-grid">
                <div class="metric-box metric-primary">
                    <div class="big-number">{{reportData.executiveSummary.automationScore}}%</div>
                    <div style="font-weight: 600; font-size: 11pt;">Automation Potential</div>
                </div>
                
                <div class="metric-box metric-success">
                    <div class="big-number">{{reportData.executiveSummary.estimatedROI}}</div>
                    <div style="font-weight: 600; font-size: 11pt;">Projected Annual ROI</div>
                </div>
                
                <div class="metric-box metric-warning">
                    <div class="big-number">{{reportData.executiveSummary.timeSavings}}</div>
                    <div style="font-weight: 600; font-size: 11pt;">Time Savings Potential</div>
                </div>
                
                <div class="metric-box metric-purple">
                    <div class="big-number">{{reportData.executiveSummary.complexityScore}}/10</div>
                    <div style="font-weight: 600; font-size: 11pt;">Implementation Complexity</div>
                </div>
            </div>
            
            <div class="subsection-title">Strategic Recommendations</div>
            <div class="content">
                <ul class="list">
                    <li>Start with {{reportData.executiveSummary.quickWins}} quick-win opportunities for immediate impact</li>
                    <li>Focus on automation tools that integrate with your existing workflow</li>
                    <li>Expect {{reportData.executiveSummary.estimatedROI}} return on investment within 6-12 months</li>
                    <li>Implement changes gradually to minimize disruption while maximizing benefits</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Process Analysis Page -->
    <div class="page page-break">
        <div class="section">
            <h1 class="section-title">Process Analysis</h1>
            
            <div class="subsection-title">Process Overview</div>
            <div class="content">
                {{processData.description}}
            </div>
            
            <table class="table">
                <thead>
                    <tr>
                        <th style="width: 30%;">Process Attribute</th>
                        <th>Current State</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Process Name</strong></td>
                        <td>{{processData.processName}}</td>
                    </tr>
                    <tr>
                        <td><strong>Industry</strong></td>
                        <td>{{processData.industry}}</td>
                    </tr>
                    <tr>
                        <td><strong>Department</strong></td>
                        <td>{{processData.department}}</td>
                    </tr>
                    <tr>
                        <td><strong>Current Volume</strong></td>
                        <td>{{processData.currentVolume}}</td>
                    </tr>
                    <tr>
                        <td><strong>Frequency</strong></td>
                        <td>{{reportData.executiveSummary.frequency}}</td>
                    </tr>
                    <tr>
                        <td><strong>Current Time Spent</strong></td>
                        <td>{{reportData.executiveSummary.currentTimeSpent}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Automation Opportunities Pages -->
    <div class="page page-break">
        <div class="section">
            <h1 class="section-title">Automation Opportunities</h1>
            
            <div class="content">
                Our AI-powered analysis has identified {{reportData.automationOpportunities.length}} specific automation opportunities within your process. These opportunities are prioritized by business impact and implementation feasibility.
            </div>
            
            {{#each reportData.automationOpportunities}}
            <div class="opportunity">
                <div class="opportunity-header">
                    <div class="opportunity-title">{{this.stepDescription}}</div>
                    <div class="priority-badge priority-{{this.priority}}">
                        {{this.priority}} Priority
                    </div>
                </div>
                
                <div class="opportunity-description">
                    <strong>Solution:</strong> {{this.solution}}
                </div>
                
                <div class="opportunity-details">
                    <div class="detail-card">
                        <div class="detail-title">Impact</div>
                        <div class="detail-content">{{this.effort}}</div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-title">Time Savings</div>
                        <div class="detail-content">{{this.timeSavings}}</div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-title">Implementation</div>
                        <div class="detail-content">{{this.estimatedCost}}</div>
                    </div>
                </div>
                
                {{#if this.implementationSteps}}
                <div class="implementation-steps">
                    <div class="detail-title">Implementation Steps:</div>
                    <ol class="steps-list">
                        {{#each this.implementationSteps}}
                        <li>{{this}}</li>
                        {{/each}}
                    </ol>
                </div>
                {{/if}}
                
                {{#if this.tools}}
                <div style="margin-top: 12px;">
                    <div class="detail-title">Recommended Tools:</div>
                    <div class="detail-content">{{join this.tools ", "}}</div>
                </div>
                {{/if}}
            </div>
            {{/each}}
        </div>
    </div>

    <!-- Implementation Roadmap Page -->
    <div class="page page-break">
        <div class="section">
            <h1 class="section-title">Implementation Roadmap</h1>
            
            {{#if reportData.roadmap.overview}}
            <div class="content">
                {{reportData.roadmap.overview}}
            </div>
            {{/if}}
            
            <div class="subsection-title">Implementation Phases</div>
            
            {{#each reportData.roadmap.phases}}
            <div class="roadmap-phase">
                <div class="phase-header">
                    <div class="phase-title">{{this.name}}</div>
                    <div class="phase-duration">{{this.duration}}</div>
                </div>
                
                <div class="phase-description">
                    {{this.description}}
                </div>
                
                <div class="phase-details">
                    <div class="detail-card">
                        <div class="detail-title">Resources Required</div>
                        <div class="detail-content">{{this.resources}}</div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-title">Investment</div>
                        <div class="detail-content">{{this.cost}}</div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-title">Expected Benefits</div>
                        <div class="detail-content">{{this.benefits}}</div>
                    </div>
                </div>
                
                {{#if this.tasks}}
                <div style="margin-top: 16px;">
                    <div class="detail-title">Key Tasks:</div>
                    <ul class="list">
                        {{#each this.tasks}}
                        <li>{{this}}</li>
                        {{/each}}
                    </ul>
                </div>
                {{/if}}
            </div>
            {{/each}}
        </div>
    </div>

    <!-- Implementation Guidance Page -->
    <div class="page page-break">
        <div class="section">
            <h1 class="section-title">Implementation Guidance</h1>
            
            {{#if reportData.implementationGuidance.overview}}
            <div class="content">
                {{reportData.implementationGuidance.overview}}
            </div>
            {{/if}}
            
            {{#if reportData.implementationGuidance.bestPractices}}
            <div class="subsection-title">Best Practices</div>
            <ul class="list">
                {{#each reportData.implementationGuidance.bestPractices}}
                <li>{{this}}</li>
                {{/each}}
            </ul>
            {{/if}}
            
            {{#if reportData.implementationGuidance.recommendations}}
            <div class="subsection-title">Strategic Recommendations</div>
            <ul class="list">
                {{#each reportData.implementationGuidance.recommendations}}
                <li>{{this}}</li>
                {{/each}}
            </ul>
            {{/if}}
            
            {{#if reportData.implementationGuidance.toolsAndTechnologies}}
            <div class="subsection-title">Recommended Tools & Technologies</div>
            {{#each reportData.implementationGuidance.toolsAndTechnologies}}
            <div class="detail-card" style="margin-bottom: 16px;">
                <div style="font-weight: 600; margin-bottom: 8px;">{{this.name}}</div>
                <div style="font-size: 10pt; color: #6b7280; margin-bottom: 6px;">{{this.category}}</div>
                <div style="font-size: 10pt;">{{this.description}}</div>
            </div>
            {{/each}}
            {{/if}}
            
            {{#if reportData.implementationGuidance.nextSteps}}
            <div class="subsection-title">Immediate Next Steps</div>
            <ol class="steps-list">
                {{#each reportData.implementationGuidance.nextSteps}}
                <li>{{this}}</li>
                {{/each}}
            </ol>
            {{/if}}
        </div>
    </div>

    <script>
        // Add page numbers and dynamic content
        document.addEventListener('DOMContentLoaded', function() {
            // Update page numbers
            const pageNumbers = document.querySelectorAll('.page-number');
            pageNumbers.forEach((element, index) => {
                element.textContent = index + 1;
            });
            
            // Add current date if not provided
            const dateElements = document.querySelectorAll('[data-current-date]');
            dateElements.forEach(element => {
                element.textContent = new Date().toLocaleDateString();
            });
        });
    </script>
</body>
</html>